import{_ as s,X as n,Y as a,a3 as e}from"./framework-a4aa538b.js";const p={},o=e(`<h1 id="聚合算子" tabindex="-1"><a class="header-anchor" href="#聚合算子" aria-hidden="true">#</a> 聚合算子</h1><h2 id="count" tabindex="-1"><a class="header-anchor" href="#count" aria-hidden="true">#</a> COUNT()</h2><p>返回非空值field values数量</p><h3 id="语法" tabindex="-1"><a class="header-anchor" href="#语法" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_CLAUSE<span class="token punctuation">]</span> FROM_CLAUSE <span class="token punctuation">[</span>WHERE_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_CLAUSE<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="嵌套语法" tabindex="-1"><a class="header-anchor" href="#嵌套语法" aria-hidden="true">#</a> 嵌套语法</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>COUNT(field_key)</code> 返回field_key对应的field value的个数。</p><p><code>COUNT(/regular_expression/)</code> 返回与正则表达式匹配的每个field key对应的field value的个数。</p><p><code>COUNT(*)</code> 返回在measurement中每个field key对应的field value的个数。</p><p><code>COUNT()</code> 支持所有数据类型的field value。openGemini支持将<code>DISTINCT()</code>函数嵌套在<code>COUNT()</code>函数里。</p><h3 id="示例" tabindex="-1"><a class="header-anchor" href="#示例" aria-hidden="true">#</a> 示例</h3><h4 id="计算指定field-key的field-value的数目" tabindex="-1"><a class="header-anchor" href="#计算指定field-key的field-value的数目" aria-hidden="true">#</a> 计算指定field key的field value的数目</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">15258</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement<code>h2o_feet</code>中的<code>water_level</code>的非空field value的数量。</p><h4 id="计数measurement中每个field-key关联的field-value的数量" tabindex="-1"><a class="header-anchor" href="#计数measurement中每个field-key关联的field-value的数量" aria-hidden="true">#</a> 计数measurement中每个field key关联的field value的数量</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count_level description <span class="token operator">|</span> count_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">15258</span>                   <span class="token operator">|</span> <span class="token number">15258</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回与measurement<code>h2o_feet</code>相关联的每个field key的非空field value的数量。<code>h2o_feet</code>有两个field keys：<code>level_description</code>和<code>water_level</code></p><h4 id="计算匹配一个正则表达式的每个field-key关联的field-value的数目" tabindex="-1"><a class="header-anchor" href="#计算匹配一个正则表达式的每个field-key关联的field-value的数目" aria-hidden="true">#</a> 计算匹配一个正则表达式的每个field key关联的field value的数目</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">/</span>water<span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">15258</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement<code>h2o_feet</code>中包含<code>water</code>单词的每个field key的非空字段值的数量。</p><h4 id="计数包括多个子句的field-key的field-value的数目" tabindex="-1"><a class="header-anchor" href="#计数包括多个子句的field-key的field-value的数目" aria-hidden="true">#</a> 计数包括多个子句的field key的field value的数目</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回<code>water_level</code>field key中的非空field value的数量。它涵盖<code>2019-08-20T00:12:01Z</code>和<code>2019-08-20T08:00:00Z</code>之间的<code>时间段</code>，并将结果分组为7分钟的时间间隔和每个tag。并用<code>1000</code>填充空的时间间隔，并返回4个数据point，表格返回1。</p><h4 id="计算一个field-key的distinct的field-value的数量" tabindex="-1"><a class="header-anchor" href="#计算一个field-key的distinct的field-value的数量" aria-hidden="true">#</a> 计算一个field key的distinct的field value的数量</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span><span class="token punctuation">(</span><span class="token string">&quot;level description&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询返回measurement为<code>h2o_feet</code>field key为<code>level description</code>的唯一field value的数量。</p><h3 id="count-的常见问题" tabindex="-1"><a class="header-anchor" href="#count-的常见问题" aria-hidden="true">#</a> <code>COUNT()</code>的常见问题</h3><h4 id="count-和fill" tabindex="-1"><a class="header-anchor" href="#count-和fill" aria-hidden="true">#</a> <code>COUNT()</code>和<code>fill()</code></h4><p>大多数函数对于没有数据的时间间隔返回<code>null</code>值，<code>fill()</code>将该<code>null</code>值替换为<code>fill_option</code>。 <code>COUNT()</code>针对没有数据的时间间隔返回<code>0</code>，<code>fill(&lt;fill_option&gt;)</code>用<code>fill_option</code>替换0值。</p><h5 id="示例-1" tabindex="-1"><a class="header-anchor" href="#示例-1" aria-hidden="true">#</a> 示例</h5><p>下面的代码块中的第一个查询不包括<code>fill()</code>。有些时间段没有数据，因此该时间间隔的值返回为零。第二个查询包括<code>fill(800000)</code>; 它将没有数据的间隔中的零替换为<code>800000</code>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span>  <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">800000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">800000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sum" tabindex="-1"><a class="header-anchor" href="#sum" aria-hidden="true">#</a> SUM()</h2><p>返回field value的总和。</p><h3 id="语法-1" tabindex="-1"><a class="header-anchor" href="#语法-1" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_CLAUSE<span class="token punctuation">]</span> FROM_CLAUSE <span class="token punctuation">[</span>WHERE_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_CLAUSE<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>SUM(field_key)</code> 返回field key对应的field value的总和。</p><p><code>SUM(/regular_expression/)</code> 返回与正则表达式匹配的每个field key对应的field value的总和。</p><p><code>SUM(*)</code> 返回在measurement中每个field key对应的field value的总和。</p><p><code>SUM()</code> 支持数据类型为int64和float64的field value。</p><h3 id="示例-2" tabindex="-1"><a class="header-anchor" href="#示例-2" aria-hidden="true">#</a> 示例</h3><h4 id="计算指定field-key对应的field-value的总和" tabindex="-1"><a class="header-anchor" href="#计算指定field-key对应的field-value的总和" aria-hidden="true">#</a> 计算指定field key对应的field value的总和</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> sum               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">67774.98933334895</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的总和。</p><h4 id="计算measurement中每个field-key对应的field-value的总和" tabindex="-1"><a class="header-anchor" href="#计算measurement中每个field-key对应的field-value的总和" aria-hidden="true">#</a> 计算measurement中每个field key对应的field value的总和</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> sum_water_level   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">67774.98933334895</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个存储数值的field key对应的field value的总和。measurement <code>h2o_feet</code>中只有一个数值类型的field：<code>water_level</code>。</p><h4 id="计算与正则表达式匹配的每个field-key对应的field-value的总和" tabindex="-1"><a class="header-anchor" href="#计算与正则表达式匹配的每个field-key对应的field-value的总和" aria-hidden="true">#</a> 计算与正则表达式匹配的每个field key对应的field value的总和</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token operator">/</span>water<span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> sum_water_level   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">67774.98933334895</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个存储数值并包含单词<code>water</code>的field key对应的field value的总和。</p><h4 id="计算指定field-key对应的field-value的总和并包含多个子句" tabindex="-1"><a class="header-anchor" href="#计算指定field-key对应的field-value的总和并包含多个子句" aria-hidden="true">#</a> 计算指定field key对应的field value的总和并包含多个子句</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> sum    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1000</span>   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.684</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">17.316</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.619</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的总和，它涵盖的时间范围在<code>2019-08-20T00:12:01Z</code>和<code>2019-08-20T08:00:00Z</code>之间，并将查询结果按7分钟的时间间隔和每个tag进行分组，同时，该查询用<code>1000</code>填充没有数据的时间间隔，并将返回的数据point个数限制为4。</p><h2 id="first" tabindex="-1"><a class="header-anchor" href="#first" aria-hidden="true">#</a> FIRST()</h2><p>返回具有最早时间戳的field value。</p><h3 id="语法-2" tabindex="-1"><a class="header-anchor" href="#语法-2" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>tag_key<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>field_key<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>INTO_CLAUSE<span class="token punctuation">]</span> FROM_CLAUSE <span class="token punctuation">[</span>WHERE_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_CLAUSE<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>FIRST(field_key)</code> 返回field key对应的具有最早时间戳的field value。</p><p><code>FIRST(/regular_expression/)</code> 返回与正则表达式匹配的每个field key对应的具有最早时间戳的field value。</p><p><code>FIRST(*)</code> 返回在measurement中每个field key对应的具有最早时间戳的field value。</p><p><code>FIRST(field_key),tag_key(s),field_key(s)</code> 返回括号中的field key对应的具有最早时间戳的field value，以及相关的tag或field。</p><p><code>FIRST()</code> 支持所有数据类型的field value。</p><h3 id="示例-3" tabindex="-1"><a class="header-anchor" href="#示例-3" aria-hidden="true">#</a> 示例</h3><h4 id="选择指定field-key对应的具有最早时间戳的field-value" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的具有最早时间戳的field-value" aria-hidden="true">#</a> 选择指定field key对应的具有最早时间戳的field value</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span><span class="token string">&quot;level description&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> <span class="token keyword">first</span>                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">6</span> <span class="token operator">and</span> <span class="token number">9</span> feet <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>level description</code>对应的具有最早时间戳的field value。</p><h4 id="选择measurement中每个field-key对应的具有最早时间戳的field-value" tabindex="-1"><a class="header-anchor" href="#选择measurement中每个field-key对应的具有最早时间戳的field-value" aria-hidden="true">#</a> 选择measurement中每个field key对应的具有最早时间戳的field value</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> first_level description <span class="token operator">|</span> first_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">6</span> <span class="token operator">and</span> <span class="token number">9</span> feet    <span class="token operator">|</span> <span class="token number">8.12</span>              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个field key对应的具有最早时间戳的field value。measurement <code>h2o_feet</code>中有两个field key：<code>level description</code>和<code>water_level</code>。</p><h4 id="选择与正则表达式匹配的每个field-key对应的具有最早时间戳的field-value" tabindex="-1"><a class="header-anchor" href="#选择与正则表达式匹配的每个field-key对应的具有最早时间戳的field-value" aria-hidden="true">#</a> 选择与正则表达式匹配的每个field key对应的具有最早时间戳的field value</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token keyword">level</span><span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> first_level description <span class="token operator">|</span> first_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">6</span> <span class="token operator">and</span> <span class="token number">9</span> feet    <span class="token operator">|</span> <span class="token number">8.12</span>              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个包含单词<code>level</code>的field key对应的具有最早时间戳的field value。</p><h4 id="选择指定field-key对应的具有最早时间戳的field-value以及相关的tag和field" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的具有最早时间戳的field-value以及相关的tag和field" aria-hidden="true">#</a> 选择指定field key对应的具有最早时间戳的field value以及相关的tag和field</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span><span class="token string">&quot;level description&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;water_level&quot;</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+--------------+-------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> <span class="token keyword">first</span>                <span class="token operator">|</span> location     <span class="token operator">|</span> water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+--------------+-------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">6</span> <span class="token operator">and</span> <span class="token number">9</span> feet <span class="token operator">|</span> coyote_creek <span class="token operator">|</span> <span class="token number">8.12</span>        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+--------------+-------------+</span>
<span class="token number">4</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>level description</code>对应的具有最早时间戳的field value，以及相关的tag key <code>location</code>和field key <code>water_level</code>的值。</p><h4 id="选择指定field-key对应的具有最早时间戳的field-value并包含多个子句" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的具有最早时间戳的field-value并包含多个子句" aria-hidden="true">#</a> 选择指定field key对应的具有最早时间戳的field value并包含多个子句</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> <span class="token keyword">first</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.684</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.661</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.619</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的具有最早时间戳的field value，它涵盖的时间范围在<code>2019-08-20T00:12:01Z</code>和<code>2019-08-20T08:00:00Z</code>之间，并将查询结果按7分钟的时间间隔和每个tag进行分组，同时，该查询用<code>1000</code>填充没有数据的时间间隔，并将返回的数据point个数限制为4。</p><h2 id="last" tabindex="-1"><a class="header-anchor" href="#last" aria-hidden="true">#</a> LAST()</h2><p>返回具有最新时间戳的field value。</p><h3 id="语法-3" tabindex="-1"><a class="header-anchor" href="#语法-3" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LAST</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>tag_key<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>field_keys<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>INTO_CLAUSE<span class="token punctuation">]</span> FROM_CLAUSE <span class="token punctuation">[</span>WHERE_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_CLAUSE<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>LAST(field_key)</code> 返回field key对应的具有最新时间戳的field value。</p><p><code>LAST(/regular_expression/)</code> 返回与正则表达式匹配的每个field key对应的具有最新时间戳的field value。</p><p><code>LAST(*)</code> 返回在measurement中每个field key对应的具有最新时间戳的field value。</p><p><code>LAST(field_key),tag_key(s),field_key(s)</code> 返回括号中的field key对应的具有最新时间戳的field value，以及相关的tag或field。</p><p><code>LAST()</code> 支持所有数据类型的field value。</p><h3 id="示例-4" tabindex="-1"><a class="header-anchor" href="#示例-4" aria-hidden="true">#</a> 示例</h3><h4 id="选择指定field-key对应的具有最新时间戳的field-value" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的具有最新时间戳的field-value" aria-hidden="true">#</a> 选择指定field key对应的具有最新时间戳的field value</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">LAST</span><span class="token punctuation">(</span><span class="token string">&quot;level description&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> <span class="token keyword">last</span>                 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span>T21:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">3</span> <span class="token operator">and</span> <span class="token number">6</span> feet <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>level description</code>对应的具有最新时间戳的field value。</p><h4 id="选择measurement中每个field-key对应的具有最新时间戳的field-value" tabindex="-1"><a class="header-anchor" href="#选择measurement中每个field-key对应的具有最新时间戳的field-value" aria-hidden="true">#</a> 选择measurement中每个field key对应的具有最新时间戳的field value</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">LAST</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> last_level description <span class="token operator">|</span> last_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">3</span> <span class="token operator">and</span> <span class="token number">6</span> feet   <span class="token operator">|</span> <span class="token number">4.938</span>            <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+------------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个field key对应的具有最新时间戳的field value。measurement <code>h2o_feet</code>中有两个field key：<code>level description</code>和<code>water_level</code>。</p><h4 id="选择与正则表达式匹配的每个field-key对应的具有最新时间戳的field-value" tabindex="-1"><a class="header-anchor" href="#选择与正则表达式匹配的每个field-key对应的具有最新时间戳的field-value" aria-hidden="true">#</a> 选择与正则表达式匹配的每个field key对应的具有最新时间戳的field value</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">LAST</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token keyword">level</span><span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> last_level description <span class="token operator">|</span> last_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">3</span> <span class="token operator">and</span> <span class="token number">6</span> feet   <span class="token operator">|</span> <span class="token number">4.938</span>            <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+------------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个包含单词<code>level</code>的field key对应的具有最新时间戳的field value。</p><h4 id="选择指定field-key对应的具有最新时间戳的field-value以及相关的tag和field" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的具有最新时间戳的field-value以及相关的tag和field" aria-hidden="true">#</a> 选择指定field key对应的具有最新时间戳的field value以及相关的tag和field</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">LAST</span><span class="token punctuation">(</span><span class="token string">&quot;level description&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;water_level&quot;</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+--------------+-------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> <span class="token keyword">last</span>                 <span class="token operator">|</span> location     <span class="token operator">|</span> water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+--------------+-------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span>T21:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">3</span> <span class="token operator">and</span> <span class="token number">6</span> feet <span class="token operator">|</span> santa_monica <span class="token operator">|</span> <span class="token number">4.938</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+----------------------+--------------+-------------+</span>
<span class="token number">4</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>level description</code>对应的具有最新时间戳的field value，以及相关的tag key <code>location</code>和field key <code>water_level</code>的值。</p><h4 id="选择指定field-key对应的具有最新时间戳的field-value并包含多个子句" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的具有最新时间戳的field-value并包含多个子句" aria-hidden="true">#</a> 选择指定field key对应的具有最新时间戳的field value并包含多个子句</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">LAST</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> <span class="token keyword">last</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.684</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.655</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.619</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的具有最新时间戳的field value，它涵盖的时间范围在<code>2019-08-20T00:12:01Z</code>和<code>2019-08-20T08:00:00Z</code>之间，并将查询结果按7分钟的时间间隔和每个tag进行分组，同时，该查询用<code>1000</code>填充没有数据的时间间隔，并将返回的数据point个数限制为4。</p><h2 id="max" tabindex="-1"><a class="header-anchor" href="#max" aria-hidden="true">#</a> MAX()</h2><p>返回field value的最大值。</p><h3 id="语法-4" tabindex="-1"><a class="header-anchor" href="#语法-4" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>tag_key<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>field__key<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>INTO_CLAUSE<span class="token punctuation">]</span> FROM_CLAUSE <span class="token punctuation">[</span>WHERE_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>SLIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>SOFFSET_CLAUSE<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>MAX(field_key)</code> 返回field key对应的field value的最大值。</p><p><code>MAX(/regular_expression/)</code> 返回与正则表达式匹配的每个field key对应的field value的最大值。</p><p><code>MAX(*)</code> 返回在measurement中每个field key对应的field value的最大值。</p><p><code>MAX(field_key),tag_key(s),field_key(s)</code> 返回括号中的field key对应的field value的最大值，以及相关的tag或field。</p><p><code>MAX()</code> 支持数据类型为int64和float64的field value。</p><h3 id="示例-5" tabindex="-1"><a class="header-anchor" href="#示例-5" aria-hidden="true">#</a> 示例</h3><h4 id="选择指定field-key对应的field-value的最大值" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的field-value的最大值" aria-hidden="true">#</a> 选择指定field key对应的field value的最大值</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> max   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">28</span>T07:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">9.964</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的最大值。</p><h4 id="选择measurement中每个field-key对应的field-value的最大值" tabindex="-1"><a class="header-anchor" href="#选择measurement中每个field-key对应的field-value的最大值" aria-hidden="true">#</a> 选择measurement中每个field key对应的field value的最大值</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> max_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">28</span>T07:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">9.964</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个存储数值的field key对应的field value的最大值。measurement <code>h2o_feet</code>中只有一个数值类型的field：<code>water_level</code>。</p><h4 id="选择与正则表达式匹配的每个field-key对应的field-value的最大值" tabindex="-1"><a class="header-anchor" href="#选择与正则表达式匹配的每个field-key对应的field-value的最大值" aria-hidden="true">#</a> 选择与正则表达式匹配的每个field key对应的field value的最大值</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token keyword">level</span><span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> max_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">28</span>T07:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">9.964</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个存储数值并包含单词<code>level</code>的field key对应的field value的最大值。</p><h4 id="选择指定field-key对应的field-value的最大值以及相关的tag和field" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的field-value的最大值以及相关的tag和field" aria-hidden="true">#</a> 选择指定field key对应的field value的最大值以及相关的tag和field</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;level description&quot;</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+--------------+---------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> max   <span class="token operator">|</span> location     <span class="token operator">|</span> <span class="token keyword">level</span> description         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+--------------+---------------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">28</span>T07:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">9.964</span> <span class="token operator">|</span> coyote_creek <span class="token operator">|</span> at <span class="token operator">or</span> greater than <span class="token number">9</span> feet <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+--------------+---------------------------+</span>
<span class="token number">4</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的最大值，以及相关的tag key <code>location</code>和field key <code>level description</code>的值。</p><h4 id="选择指定field-key对应的field-value的最大值并包含多个子句" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的field-value的最大值并包含多个子句" aria-hidden="true">#</a> 选择指定field key对应的field value的最大值并包含多个子句</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> max   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.684</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.661</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.619</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的最大值，它涵盖的时间范围在<code>2019-08-20T00:12:01Z</code>和<code>2019-08-20T08:00:00Z</code>之间，并将查询结果按7分钟的时间间隔和每个tag进行分组，同时，该查询用<code>1000</code>填充没有数据的时间间隔，并将返回的数据point个数限制为4。</p><h2 id="min" tabindex="-1"><a class="header-anchor" href="#min" aria-hidden="true">#</a> MIN()</h2><p>返回field value的最小值。</p><h3 id="语法-5" tabindex="-1"><a class="header-anchor" href="#语法-5" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>tag_key<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>field_key<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>INTO_CLAUSE<span class="token punctuation">]</span> FROM_CLAUSE <span class="token punctuation">[</span>WHERE_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_CLAUSE<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>MIN(field_key)</code> 返回field key对应的field value的最小值。</p><p><code>MIN(/regular_expression/)</code> 返回与正则表达式匹配的每个field key对应的field value的最小值。</p><p><code>MIN(*)</code> 返回在measurement中每个field key对应的field value的最小值。</p><p><code>MIN(field_key),tag_key(s),field_key(s)</code> 返回括号中的field key对应的field value的最小值，以及相关的tag和/或field。</p><p><code>MIN()</code>支持数据类型为int64和float64的field value。</p><h3 id="示例-6" tabindex="-1"><a class="header-anchor" href="#示例-6" aria-hidden="true">#</a> 示例</h3><h4 id="选择指定field-key对应的field-value的最小值" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的field-value的最小值" aria-hidden="true">#</a> 选择指定field key对应的field value的最小值</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> min   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">28</span>T14:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.61</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的最小值。</p><h4 id="选择measurement中每个field-key对应的field-value的最小值" tabindex="-1"><a class="header-anchor" href="#选择measurement中每个field-key对应的field-value的最小值" aria-hidden="true">#</a> 选择measurement中每个field key对应的field value的最小值</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> min_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">28</span>T14:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.61</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个存储数值的field key对应的field value的最小值。measurement <code>h2o_feet</code>中只有一个数值类型的field：<code>water_level</code>。</p><h4 id="选择与正则表达式匹配的每个field-key对应的field-value的最小值" tabindex="-1"><a class="header-anchor" href="#选择与正则表达式匹配的每个field-key对应的field-value的最小值" aria-hidden="true">#</a> 选择与正则表达式匹配的每个field key对应的field value的最小值</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token keyword">level</span><span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> min_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">28</span>T14:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.61</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-----------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个存储数值并包含单词<code>level</code>的field key对应的field value的最小值。</p><h4 id="选择指定field-key对应的field-value的最小值以及相关的tag和field" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的field-value的最小值以及相关的tag和field" aria-hidden="true">#</a> 选择指定field key对应的field value的最小值以及相关的tag和field</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;level description&quot;</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+--------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> min   <span class="token operator">|</span> location     <span class="token operator">|</span> <span class="token keyword">level</span> description <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+--------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">28</span>T14:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.61</span> <span class="token operator">|</span> coyote_creek <span class="token operator">|</span> below <span class="token number">3</span> feet      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+--------------+-------------------+</span>
<span class="token number">4</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的最小值，以及相关的tag key <code>location</code>和field key <code>level description</code>的值。</p><h4 id="选择指定field-key对应的field-value的最小值并包含多个子句" tabindex="-1"><a class="header-anchor" href="#选择指定field-key对应的field-value的最小值并包含多个子句" aria-hidden="true">#</a> 选择指定field key对应的field value的最小值并包含多个子句</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> min   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.684</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.655</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.619</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的最小值，它涵盖的时间范围在<code>2019-08-20T00:12:01Z</code>和<code>2019-08-20T08:00:00Z</code>之间，并将查询结果按7分钟的时间间隔和每个tag进行分组，同时，该查询用<code>1000</code>填充没有数据的时间间隔，并将返回的数据point个数限制为4。</p>`,154),t=[o];function l(c,r){return n(),a("div",null,t)}const k=s(p,[["render",l],["__file","functions.html.vue"]]);export{k as default};
